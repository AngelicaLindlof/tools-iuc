<tool id="pl.pca_loadings" name="pl.pca_loadings" version="1.3.1+galaxy1">
    <description>Rank genes according to contributions to PCs</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
          python $script_file
      ]]></command>
    <configfiles>
        <configfile name="script_file"><![CDATA[
@CMD_imports@
@CMD_read_inputs@
sc.settings.figdir = '.'

components=[]
#for $i, $s in enumerate($components)
components.append($s.comp)
#end for

sc.pl.pca_loadings(
    adata=adata,
    components=components,
    show=False,
    save='.$format')
]]></configfile>
    </configfiles>
    <inputs>
        <expand macro="inputs_anndata"/>
        <repeat name="components" title="Component" min="2">
            <param name="comp" type="integer" value="1" label="Component" help="1, 2, 3 means first, second and third principal components"/>
        </repeat>
        <expand macro="param_plot_format"/>
    </inputs>
    <outputs>
        <expand macro="plot_output"/>
    </outputs>
    <tests>
        <test>
            <conditional name="input">
                <param name="format" value="h5ad" />
                <param name="adata" value="pp.pca.krumsiek11.h5ad" />
            </conditional>
            <repeat name="components">
                <param name="comp" value="1"/>
            </repeat>
            <repeat name="components">
                <param name="comp" value="2"/>
            </repeat>
            <repeat name="components">
                <param name="comp" value="3"/>
            </repeat>
            <param name="format" value="png"/>
            <output name="out_png" file="pl.pca_loadings.pp.pca.krumsiek11.png"/>
        </test>
    </tests>
    <help><![CDATA[
Rank genes according to contributions to PCs.

More details on the `scanpy documentation
<https://scanpy.readthedocs.io/en/latest/api/scanpy.api.pl.pca_loadings.html#scanpy.api.pl.pca_loadings>`__
    ]]></help>
    <expand macro="citations"/>
</tool>
