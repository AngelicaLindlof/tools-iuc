<tool id="utils.identify_groups" name="utils.identify_groups" version="1.3.1+galaxy1">
  <description>Which predicted label explains which reference label?</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <command detect_errors="exit_code"><![CDATA[
        python $script_file
    ]]></command>
  <configfiles>
    <configfile name="script_file"><![CDATA[
import scanpy.api as sc



sc.utils.identify_groups()
]]></configfile>
  </configfiles>
  <inputs>
    </inputs>
  <outputs>
    <data name="A dictionary of length ``len(np.unique(ref_labels))`` that stores for each" type="data" format="" label="${tool.name} on ${on_string}: A dictionary of length ``len(np.unique(ref_labels))`` that stores for each"/>
    <data name="reference label the predicted label that best explains it." type="data" format="" label="${tool.name} on ${on_string}: reference label the predicted label that best explains it."/>
    <data name="If ``return_overlaps`` is ``True``, this will in addition return the overlap" type="data" format="" label="${tool.name} on ${on_string}: If ``return_overlaps`` is ``True``, this will in addition return the overlap"/>
    <data name="of the reference group with the predicted group; normalized with respect to" type="data" format="" label="${tool.name} on ${on_string}: of the reference group with the predicted group; normalized with respect to"/>
    <data name="the reference group size and the predicted group size, respectively." type="data" format="" label="${tool.name} on ${on_string}: the reference group size and the predicted group size, respectively."/>
    </outputs>
  <tests>
    <test>
      <output name="A dictionary of length ``len(np.unique(ref_labels))`` that stores for each" file=""/>
      <output name="reference label the predicted label that best explains it." file=""/>
      <output name="If ``return_overlaps`` is ``True``, this will in addition return the overlap" file=""/>
      <output name="of the reference group with the predicted group; normalized with respect to" file=""/>
      <output name="the reference group size and the predicted group size, respectively." file=""/>
    </test>
  </tests>
  <help><![CDATA[
        Which predicted label explains which reference label?

A predicted label explains the reference label which maximizes the minimum
of ``relative_overlaps_pred`` and ``relative_overlaps_ref``.

Compare this with ``compute_association_matrix_of_groups``.

Returns
-------
A dictionary of length ``len(np.unique(ref_labels))`` that stores for each
reference label the predicted label that best explains it.

If ``return_overlaps`` is ``True``, this will in addition return the overlap
of the reference group with the predicted group; normalized with respect to
the reference group size and the predicted group size, respectively.
    ]]></help>
  <expand macro="citations"/>
</tool>
