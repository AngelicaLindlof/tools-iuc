<tool id="pl.dpt_timeseries" name="pl.dpt_timeseries" version="1.3.1+galaxy1">
    <description>Heatmap of pseudotime series</description>
    <macros>
      <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
          python $script_file
      ]]></command>
    <configfiles>
      <configfile name="script_file"><![CDATA[
@CMD_imports@
@CMD_read_inputs@
sc.settings.figdir = '.'

sc.pl.dpt_timeseries(
    adata=adata,
    as_heatmap=$heatmap.as_heatmap,
#if $heatmap.as_heatmap == "True"
    color_map='$heatmap.color_map',
#end if
    show=False,
    save='.$format')
]]></configfile>
    </configfiles>
    <inputs>
        <expand macro="inputs_anndata"/>
        <conditional name="heatmap">
            <param argument="as_heatmap" type="select" label="Plot the timeseries as heatmap?" help="">
                <option value="True">Yes</option>
                <option value="False">No</option>
            </param>
            <when value="True">
                <param argument="color_map" type="select" label="Colors to use for plotting categorical annotation groups" help="">
                    <expand macro="matplotlib_pyplot_colormap"/>
                </param>
            </when>
            <when value="False" />
        </conditional>
        <expand macro="param_plot_format"/>
    </inputs>
    <outputs>
        <expand macro="plot_output"/>
    </outputs>
    <tests>
        <test>
            <conditional name="input">
                <param name="format" value="h5ad" />
                <param name="adata" value="tl.dpt.neighbors.paul15_gauss_braycurtis.h5ad" />
            </conditional>
            <conditional name="heatmap">
                <param name="as_heatmap" value="True"/>
                <param name="color_map" value="viridis"/>
            </conditional>
            <param name="format" value="png"/>
            <output name="out_png" file="pl.dpt_timeseries.paul15_gauss_braycurtis.png" ftype="png" compare="sim_size"/>
        </test>
    </tests>
    <help><![CDATA[
Heatmap of pseudotime series.

More details on the `scanpy documentation
<https://scanpy.readthedocs.io/en/latest/api/scanpy.api.pl.dpt_timeseries.html#scanpy.api.pl.dpt_timeseries>`__
    ]]></help>
    <expand macro="citations"/>
</tool>