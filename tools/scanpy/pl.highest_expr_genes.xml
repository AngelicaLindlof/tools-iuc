<tool id="pl.highest_expr_genes" name="pl.highest_expr_genes" version="1.3.1+galaxy1">
  <description>Fraction of counts assigned to each gene over all cells.</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <command detect_errors="exit_code"><![CDATA[
        python $script_file
    ]]></command>
  <configfiles>
    <configfile name="script_file"><![CDATA[
import scanpy.api as sc
@CMD_set_figure_params
@CMD_read_inputs

sc.pl.highest_expr_genes(
   adata = '$adata',
   n_top = '$n_top',
   show = '$show',
   save = '$save',
   ax = '$ax',
   **kwds = '$**kwds',)
]]></configfile>
  </configfiles>
  <inputs>
    <expand macro="inputs_anndata"/>
    <param name="n_top" type="int" value="" optional="true" label="n_top" help="    Number of top"/>
    <param name="show" type="bool" value="None" optional="true" label="show" help="     Show the plot, do not return axis."/>
    <param name="save" type="bool" value="None" optional="true" label="save" help="    If `True` or a `str`, save the figure. A string is appended to the default    filename. Infer the filetype if ending on {'.pdf', '.png', '.svg'}."/>
    <param name="ax" type="matplotlib.Axes" value="None" optional="true" label="ax" help="    A matplotlib axes object. Only works if plotting a single component."/>
    <param name="**kwds" type="data" format="keyword arguments" value="" label="**kwds" help="    Are passed to `seaborn.boxplot`."/>
    <section name="pl_settings" title="Plot settings" expanded="false"><expand macro="inputs_set_figure_params"/></section></inputs>
  <outputs>
    <data name="If `show==False` a `matplotlib.Axis`." type="data" format="" label="${tool.name} on ${on_string}: If `show==False` a `matplotlib.Axis`."/>
    </outputs>
  <tests>
    <test>
      <param name="n_top" value=""/>
      <param name="show" value=""/>
      <param name="save" value=""/>
      <param name="ax" value=""/>
      <param name="**kwds" value=""/>
      <expand macro="tests_set_figure_params"/>
      <output name="If `show==False` a `matplotlib.Axis`." file=""/>
    </test>
  </tests>
  <help><![CDATA[
        Fraction of counts assigned to each gene over all cells.

Computes, for each gene, the fraction of counts assigned to that gene within
a cell. The `n_top` genes with the highest mean fraction over all cells are
plotted as boxplots.

This plot is similar to the `scater` package function `plotHighestExprs(type
= "highest-expression")`, see `here
<https://bioconductor.org/packages/devel/bioc/vignettes/scater/inst/doc/vignette-qc.html>`__. Quoting
from there:

    *We expect to see the “usual suspects”, i.e., mitochondrial genes, actin,
    ribosomal protein, MALAT1. A few spike-in transcripts may also be
    present here, though if all of the spike-ins are in the top 50, it
    suggests that too much spike-in RNA was added. A large number of
    pseudo-genes or predicted genes may indicate problems with alignment.*
    -- Davis McCarthy and Aaron Lun

Parameters
----------
adata : :class:`~anndata.AnnData`
    Annotated data matrix.
n_top : `int`, optional (default:30)
    Number of top
show : `bool`, optional (default: `None`)
     Show the plot, do not return axis.
save : `bool` or `str`, optional (default: `None`)
    If `True` or a `str`, save the figure. A string is appended to the default
    filename. Infer the filetype if ending on {'.pdf', '.png', '.svg'}.
ax : `matplotlib.Axes`, optional (default: `None`)
    A matplotlib axes object. Only works if plotting a single component.
**kwds : keyword arguments
    Are passed to `seaborn.boxplot`.

Returns
-------
If `show==False` a `matplotlib.Axis`.
    ]]></help>
  <expand macro="citations"/>
</tool>
