<tool id="tl.score_genes_cell_cycle" name="tl.score_genes_cell_cycle" version="1.3.1+galaxy1">
  <description>Score cell cycle genes [Satija15]_.</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <command detect_errors="exit_code"><![CDATA[
        python $script_file
    ]]></command>
  <configfiles>
    <configfile name="script_file"><![CDATA[
import scanpy.api as sc

@CMD_read_inputs

sc.tl.score_genes_cell_cycle(
   adata = '$adata',
   s_genes = '$s_genes',
   g2m_genes = '$g2m_genes',
   copy = '$copy',
   **kwargs = '$**kwargs',)

adata.write_loom($csv_output)
adata.write_csv($loom_output)
]]></configfile>
  </configfiles>
  <inputs>
    <expand macro="inputs_anndata"/>
    <param name="s_genes" type="list" value="" label="s_genes" help="    List of genes associated with S phase."/>
    <param name="g2m_genes" type="list" value="" label="g2m_genes" help="    List of genes associated with G2M phase."/>
    <param name="copy" type="bool" value="False" optional="true" label="copy" help="    Copy `adata` or modify it inplace."/>
    <param name="**kwargs" type="data" format="optional keyword arguments" value="" optional="true" label="**kwargs" help="    Are passed to :func:`~scanpy.api.score_genes`. `ctrl_size` is not    possible, as it's set as `min(len(s_genes), len(g2m_genes))`."/>
    </inputs>
  <outputs>
    <data name="csv_output" type="data" format="csv" label="${tool.name} on ${on_string}: Annotated matrix (csv)"/>
    <data name="S_score" type="adata.obs" label="${tool.name} on ${on_string}: S_score"/>
    <data name="G2M_score" type="adata.obs" label="${tool.name} on ${on_string}: G2M_score"/>
    <data name="phase" type="adata.obs" label="${tool.name} on ${on_string}: phase"/>
    <data name="See also" type="data" format="" label="${tool.name} on ${on_string}: See also"/>
    <data name="--------" type="data" format="" label="${tool.name} on ${on_string}: --------"/>
    <data name="score_genes" type="data" format="" label="${tool.name} on ${on_string}: score_genes"/>
    <data name="loom_output" type="data" format="loom" label="${tool.name} on ${on_string}: Annotated matrix (loom)"/>
    </outputs>
  <tests>
    <test>
      <param name="s_genes" value=""/>
      <param name="g2m_genes" value=""/>
      <param name="copy" value=""/>
      <param name="**kwargs" value=""/>
      <output name="loom_output" file=""/>
      <output name="csv_output" file=""/>
      <output name="S_score" file=""/>
      <output name="G2M_score" file=""/>
      <output name="phase" file=""/>
      <output name="See also" file=""/>
      <output name="--------" file=""/>
      <output name="score_genes" file=""/>
      <output name="loom_output" file=""/>
    </test>
  </tests>
  <help><![CDATA[
        Score cell cycle genes [Satija15]_.

Given two lists of genes associated to S phase and G2M phase, calculates
scores and assigns a cell cycle phase (G1, S or G2M). See
:func:`~scanpy.api.score_genes` for more explanation.

Parameters
----------
adata : :class:`~anndata.AnnData`
    The annotated data matrix.
s_genes : `list`
    List of genes associated with S phase.
g2m_genes : `list`
    List of genes associated with G2M phase.
copy : `bool`, optional (default: `False`)
    Copy `adata` or modify it inplace.
**kwargs : optional keyword arguments
    Are passed to :func:`~scanpy.api.score_genes`. `ctrl_size` is not
    possible, as it's set as `min(len(s_genes), len(g2m_genes))`.

Returns
-------
Depending on `copy`, returns or updates `adata` with the following fields.

S_score : `adata.obs`, dtype `object`
    The score for S phase for each cell.
G2M_score : `adata.obs`, dtype `object`
    The score for G2M phase for each cell.
phase : `adata.obs`, dtype `object`
    The cell cycle phase (`S`, `G2M` or `G1`) for each cell.

See also
--------
score_genes

Examples
--------
See this `notebook <https://github.com/theislab/scanpy_usage/tree/master/180209_cell_cycle>`__.
    ]]></help>
  <expand macro="citations"/>
</tool>
